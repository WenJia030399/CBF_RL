Using cpu device
-----------------------------
| time/              |      |
|    fps             | 43   |
|    iterations      | 1    |
|    time_elapsed    | 23   |
|    total_timesteps | 1024 |
-----------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 45          |
|    iterations           | 2           |
|    time_elapsed         | 45          |
|    total_timesteps      | 2048        |
| train/                  |             |
|    approx_kl            | 0.007972565 |
|    clip_fraction        | 0.108       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.26       |
|    explained_variance   | -0.000587   |
|    learning_rate        | 0.0003      |
|    loss                 | 5.79e+03    |
|    n_updates            | 10          |
|    policy_gradient_loss | 0.00137     |
|    std                  | 0.368       |
|    value_loss           | 1.14e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 48          |
|    iterations           | 3           |
|    time_elapsed         | 63          |
|    total_timesteps      | 3072        |
| train/                  |             |
|    approx_kl            | 0.005783213 |
|    clip_fraction        | 0.0647      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.26       |
|    explained_variance   | -0.0144     |
|    learning_rate        | 0.0003      |
|    loss                 | 1.11e+04    |
|    n_updates            | 20          |
|    policy_gradient_loss | 0.000593    |
|    std                  | 0.368       |
|    value_loss           | 2.26e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 48          |
|    iterations           | 4           |
|    time_elapsed         | 85          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.020732436 |
|    clip_fraction        | 0.145       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.26       |
|    explained_variance   | -6.93e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 1.5e+04     |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.00091    |
|    std                  | 0.368       |
|    value_loss           | 3.22e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 49          |
|    iterations           | 5           |
|    time_elapsed         | 103         |
|    total_timesteps      | 5120        |
| train/                  |             |
|    approx_kl            | 0.006255604 |
|    clip_fraction        | 0.104       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.25       |
|    explained_variance   | -4.84e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 2.45e+04    |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.00321    |
|    std                  | 0.367       |
|    value_loss           | 4.97e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 50          |
|    iterations           | 6           |
|    time_elapsed         | 121         |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.009424139 |
|    clip_fraction        | 0.136       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.23       |
|    explained_variance   | 0.000289    |
|    learning_rate        | 0.0003      |
|    loss                 | 1.29e+04    |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.000791   |
|    std                  | 0.363       |
|    value_loss           | 2.62e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 51          |
|    iterations           | 7           |
|    time_elapsed         | 139         |
|    total_timesteps      | 7168        |
| train/                  |             |
|    approx_kl            | 0.006437232 |
|    clip_fraction        | 0.114       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.22       |
|    explained_variance   | -2.38e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 1.38e+04    |
|    n_updates            | 60          |
|    policy_gradient_loss | 0.00297     |
|    std                  | 0.364       |
|    value_loss           | 2.82e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 50          |
|    iterations           | 8           |
|    time_elapsed         | 161         |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.010166722 |
|    clip_fraction        | 0.203       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.22       |
|    explained_variance   | -2.13e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 9.86e+03    |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.00115    |
|    std                  | 0.362       |
|    value_loss           | 1.97e+04    |
-----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 50           |
|    iterations           | 9            |
|    time_elapsed         | 183          |
|    total_timesteps      | 9216         |
| train/                  |              |
|    approx_kl            | 0.0065521114 |
|    clip_fraction        | 0.136        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.2         |
|    explained_variance   | 0.00142      |
|    learning_rate        | 0.0003       |
|    loss                 | 8.02e+03     |
|    n_updates            | 80           |
|    policy_gradient_loss | -0.00223     |
|    std                  | 0.36         |
|    value_loss           | 1.66e+04     |
------------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 50         |
|    iterations           | 10         |
|    time_elapsed         | 201        |
|    total_timesteps      | 10240      |
| train/                  |            |
|    approx_kl            | 0.01009382 |
|    clip_fraction        | 0.197      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.19      |
|    explained_variance   | 0.000811   |
|    learning_rate        | 0.0003     |
|    loss                 | 2.28e+03   |
|    n_updates            | 90         |
|    policy_gradient_loss | 0.00612    |
|    std                  | 0.36       |
|    value_loss           | 4.83e+03   |
----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 51           |
|    iterations           | 11           |
|    time_elapsed         | 219          |
|    total_timesteps      | 11264        |
| train/                  |              |
|    approx_kl            | 0.0071864678 |
|    clip_fraction        | 0.133        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.18        |
|    explained_variance   | 3.04e-06     |
|    learning_rate        | 0.0003       |
|    loss                 | 3.35e+03     |
|    n_updates            | 100          |
|    policy_gradient_loss | 0.00428      |
|    std                  | 0.357        |
|    value_loss           | 7.03e+03     |
------------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 51         |
|    iterations           | 12         |
|    time_elapsed         | 237        |
|    total_timesteps      | 12288      |
| train/                  |            |
|    approx_kl            | 0.00841671 |
|    clip_fraction        | 0.0905     |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.15      |
|    explained_variance   | 5.96e-07   |
|    learning_rate        | 0.0003     |
|    loss                 | 5.07e+03   |
|    n_updates            | 110        |
|    policy_gradient_loss | 0.000662   |
|    std                  | 0.354      |
|    value_loss           | 1.08e+04   |
----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 13          |
|    time_elapsed         | 255         |
|    total_timesteps      | 13312       |
| train/                  |             |
|    approx_kl            | 0.011783638 |
|    clip_fraction        | 0.154       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.13       |
|    explained_variance   | 1.61e-06    |
|    learning_rate        | 0.0003      |
|    loss                 | 6.55e+03    |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.00263    |
|    std                  | 0.352       |
|    value_loss           | 1.3e+04     |
-----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 50           |
|    iterations           | 14           |
|    time_elapsed         | 282          |
|    total_timesteps      | 14336        |
| train/                  |              |
|    approx_kl            | 0.0065766918 |
|    clip_fraction        | 0.21         |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.13        |
|    explained_variance   | 9.54e-07     |
|    learning_rate        | 0.0003       |
|    loss                 | 2.21e+03     |
|    n_updates            | 130          |
|    policy_gradient_loss | -0.00202     |
|    std                  | 0.355        |
|    value_loss           | 4.92e+03     |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 51          |
|    iterations           | 15          |
|    time_elapsed         | 300         |
|    total_timesteps      | 15360       |
| train/                  |             |
|    approx_kl            | 0.010347355 |
|    clip_fraction        | 0.0992      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.14       |
|    explained_variance   | -6.43e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 1.32e+04    |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.00326    |
|    std                  | 0.354       |
|    value_loss           | 2.9e+04     |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 51          |
|    iterations           | 16          |
|    time_elapsed         | 318         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.008001971 |
|    clip_fraction        | 0.116       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.12       |
|    explained_variance   | -4.29e-06   |
|    learning_rate        | 0.0003      |
|    loss                 | 4.3e+03     |
|    n_updates            | 150         |
|    policy_gradient_loss | 0.000777    |
|    std                  | 0.35        |
|    value_loss           | 8.98e+03    |
-----------------------------------------
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    main()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    model.learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 478, in step
    self.twist.linear.y = float(u_safe[1])
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/__init__.py", line 206, in spin_once
    executor.spin_once(timeout_sec=timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 739, in spin_once
    self._spin_once_impl(timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 728, in _spin_once_impl
    handler, entity, node = self.wait_for_ready_callbacks(timeout_sec=timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 711, in wait_for_ready_callbacks
    return next(self._cb_iter)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 608, in _wait_for_ready_callbacks
    wait_set.wait(timeout_nsec)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    main()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    model.learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 478, in step
    self.twist.linear.y = float(u_safe[1])
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/__init__.py", line 206, in spin_once
    executor.spin_once(timeout_sec=timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 739, in spin_once
    self._spin_once_impl(timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 728, in _spin_once_impl
    handler, entity, node = self.wait_for_ready_callbacks(timeout_sec=timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 711, in wait_for_ready_callbacks
    return next(self._cb_iter)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 608, in _wait_for_ready_callbacks
    wait_set.wait(timeout_nsec)
KeyboardInterrupt
