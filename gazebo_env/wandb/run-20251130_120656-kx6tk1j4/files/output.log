Using cpu device
Spawning roof obstacle with fixed size and color
-----------------------------
| time/              |      |
|    fps             | 54   |
|    iterations      | 1    |
|    time_elapsed    | 18   |
|    total_timesteps | 1024 |
-----------------------------
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    main()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    model.learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 477, in step
    u_safe = self._solve_projection(u_rl, self.pos)
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 389, in _solve_projection
    res = minimize(obj, x0, jac=jac, bounds=bounds, constraints=cons,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_minimize.py", line 750, in minimize
    res = _minimize_slsqp(fun, x0, args, jac, bounds,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_slsqp_py.py", line 436, in _minimize_slsqp
    c = _eval_constraint(x, cons)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_slsqp_py.py", line 480, in _eval_constraint
    c_ieq = concatenate([atleast_1d(con['fun'](x, *con['args']))
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    main()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    model.learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 477, in step
    u_safe = self._solve_projection(u_rl, self.pos)
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 389, in _solve_projection
    res = minimize(obj, x0, jac=jac, bounds=bounds, constraints=cons,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_minimize.py", line 750, in minimize
    res = _minimize_slsqp(fun, x0, args, jac, bounds,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_slsqp_py.py", line 436, in _minimize_slsqp
    c = _eval_constraint(x, cons)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_slsqp_py.py", line 480, in _eval_constraint
    c_ieq = concatenate([atleast_1d(con['fun'](x, *con['args']))
KeyboardInterrupt
