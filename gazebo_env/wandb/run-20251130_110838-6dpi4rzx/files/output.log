Using cpu device
-----------------------------
| time/              |      |
|    fps             | 52   |
|    iterations      | 1    |
|    time_elapsed    | 19   |
|    total_timesteps | 1024 |
-----------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 2           |
|    time_elapsed         | 37          |
|    total_timesteps      | 2048        |
| train/                  |             |
|    approx_kl            | 0.008582793 |
|    clip_fraction        | 0.14        |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.26       |
|    explained_variance   | 0.00123     |
|    learning_rate        | 0.0003      |
|    loss                 | 2.03e+04    |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.000846   |
|    std                  | 0.369       |
|    value_loss           | 3.95e+04    |
-----------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 54         |
|    iterations           | 3          |
|    time_elapsed         | 55         |
|    total_timesteps      | 3072       |
| train/                  |            |
|    approx_kl            | 0.01270492 |
|    clip_fraction        | 0.125      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.26      |
|    explained_variance   | 2.09e-06   |
|    learning_rate        | 0.0003     |
|    loss                 | 2.79e+04   |
|    n_updates            | 20         |
|    policy_gradient_loss | 0.000368   |
|    std                  | 0.368      |
|    value_loss           | 5.58e+04   |
----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 55           |
|    iterations           | 4            |
|    time_elapsed         | 73           |
|    total_timesteps      | 4096         |
| train/                  |              |
|    approx_kl            | 0.0032469463 |
|    clip_fraction        | 0.131        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.26        |
|    explained_variance   | -9.54e-07    |
|    learning_rate        | 0.0003       |
|    loss                 | 2.85e+04     |
|    n_updates            | 30           |
|    policy_gradient_loss | 0.00116      |
|    std                  | 0.367        |
|    value_loss           | 5.68e+04     |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 53          |
|    iterations           | 5           |
|    time_elapsed         | 95          |
|    total_timesteps      | 5120        |
| train/                  |             |
|    approx_kl            | 0.018573891 |
|    clip_fraction        | 0.145       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.25       |
|    explained_variance   | -2.38e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 2.67e+04    |
|    n_updates            | 40          |
|    policy_gradient_loss | 0.000371    |
|    std                  | 0.367       |
|    value_loss           | 5.48e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 53          |
|    iterations           | 6           |
|    time_elapsed         | 114         |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.008672144 |
|    clip_fraction        | 0.108       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.24       |
|    explained_variance   | 0.0166      |
|    learning_rate        | 0.0003      |
|    loss                 | 2.48e+04    |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.000257   |
|    std                  | 0.365       |
|    value_loss           | 4.91e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 7           |
|    time_elapsed         | 131         |
|    total_timesteps      | 7168        |
| train/                  |             |
|    approx_kl            | 0.011213024 |
|    clip_fraction        | 0.117       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.24       |
|    explained_variance   | -0.002      |
|    learning_rate        | 0.0003      |
|    loss                 | 4.63e+04    |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.00416    |
|    std                  | 0.367       |
|    value_loss           | 1.04e+05    |
-----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 54           |
|    iterations           | 8            |
|    time_elapsed         | 150          |
|    total_timesteps      | 8192         |
| train/                  |              |
|    approx_kl            | 0.0035716933 |
|    clip_fraction        | 0.0929       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.25        |
|    explained_variance   | 1.55e-06     |
|    learning_rate        | 0.0003       |
|    loss                 | 9.09e+04     |
|    n_updates            | 70           |
|    policy_gradient_loss | 0.00277      |
|    std                  | 0.368        |
|    value_loss           | 1.8e+05      |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 9           |
|    time_elapsed         | 168         |
|    total_timesteps      | 9216        |
| train/                  |             |
|    approx_kl            | 0.006643028 |
|    clip_fraction        | 0.123       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.26       |
|    explained_variance   | 2.98e-07    |
|    learning_rate        | 0.0003      |
|    loss                 | 9.01e+04    |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.000774   |
|    std                  | 0.368       |
|    value_loss           | 1.8e+05     |
-----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 53           |
|    iterations           | 10           |
|    time_elapsed         | 190          |
|    total_timesteps      | 10240        |
| train/                  |              |
|    approx_kl            | 0.0129718855 |
|    clip_fraction        | 0.142        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.25        |
|    explained_variance   | 1.79e-07     |
|    learning_rate        | 0.0003       |
|    loss                 | 9.02e+04     |
|    n_updates            | 90           |
|    policy_gradient_loss | -0.000509    |
|    std                  | 0.367        |
|    value_loss           | 1.8e+05      |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 11          |
|    time_elapsed         | 208         |
|    total_timesteps      | 11264       |
| train/                  |             |
|    approx_kl            | 0.014836129 |
|    clip_fraction        | 0.102       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.26       |
|    explained_variance   | -1.32e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 6.75e+04    |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.000662   |
|    std                  | 0.369       |
|    value_loss           | 1.39e+05    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 12          |
|    time_elapsed         | 226         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.018216433 |
|    clip_fraction        | 0.317       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.27       |
|    explained_variance   | -1.19e-06   |
|    learning_rate        | 0.0003      |
|    loss                 | 3.61e+03    |
|    n_updates            | 110         |
|    policy_gradient_loss | 0.0103      |
|    std                  | 0.369       |
|    value_loss           | 7.5e+03     |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 13          |
|    time_elapsed         | 244         |
|    total_timesteps      | 13312       |
| train/                  |             |
|    approx_kl            | 0.008902148 |
|    clip_fraction        | 0.149       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.25       |
|    explained_variance   | 1.73e-06    |
|    learning_rate        | 0.0003      |
|    loss                 | 2.94e+03    |
|    n_updates            | 120         |
|    policy_gradient_loss | 0.00633     |
|    std                  | 0.365       |
|    value_loss           | 6.04e+03    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 14          |
|    time_elapsed         | 262         |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 0.015348818 |
|    clip_fraction        | 0.211       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.22       |
|    explained_variance   | -4.05e-06   |
|    learning_rate        | 0.0003      |
|    loss                 | 2.49e+03    |
|    n_updates            | 130         |
|    policy_gradient_loss | 0.00404     |
|    std                  | 0.363       |
|    value_loss           | 5.06e+03    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 53          |
|    iterations           | 15          |
|    time_elapsed         | 284         |
|    total_timesteps      | 15360       |
| train/                  |             |
|    approx_kl            | 0.006599465 |
|    clip_fraction        | 0.175       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.2        |
|    explained_variance   | -3.58e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 1.9e+03     |
|    n_updates            | 140         |
|    policy_gradient_loss | 0.00309     |
|    std                  | 0.359       |
|    value_loss           | 3.88e+03    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 16          |
|    time_elapsed         | 302         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.010236783 |
|    clip_fraction        | 0.118       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.19       |
|    explained_variance   | -1.05e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 6.95e+03    |
|    n_updates            | 150         |
|    policy_gradient_loss | -0.000851   |
|    std                  | 0.361       |
|    value_loss           | 1.57e+04    |
-----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 54           |
|    iterations           | 17           |
|    time_elapsed         | 321          |
|    total_timesteps      | 17408        |
| train/                  |              |
|    approx_kl            | 0.0058625466 |
|    clip_fraction        | 0.0941       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.21        |
|    explained_variance   | -2.99e-05    |
|    learning_rate        | 0.0003       |
|    loss                 | 3.36e+04     |
|    n_updates            | 160          |
|    policy_gradient_loss | -0.00246     |
|    std                  | 0.363        |
|    value_loss           | 6.61e+04     |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 18          |
|    time_elapsed         | 339         |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.008253248 |
|    clip_fraction        | 0.189       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.21       |
|    explained_variance   | 2.98e-07    |
|    learning_rate        | 0.0003      |
|    loss                 | 3.66e+04    |
|    n_updates            | 170         |
|    policy_gradient_loss | -0.00794    |
|    std                  | 0.362       |
|    value_loss           | 7.24e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 19          |
|    time_elapsed         | 357         |
|    total_timesteps      | 19456       |
| train/                  |             |
|    approx_kl            | 0.007820804 |
|    clip_fraction        | 0.063       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.2        |
|    explained_variance   | -3.58e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 3.35e+04    |
|    n_updates            | 180         |
|    policy_gradient_loss | 0.000143    |
|    std                  | 0.361       |
|    value_loss           | 6.86e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 53          |
|    iterations           | 20          |
|    time_elapsed         | 379         |
|    total_timesteps      | 20480       |
| train/                  |             |
|    approx_kl            | 0.008665948 |
|    clip_fraction        | 0.0736      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.2        |
|    explained_variance   | -1.19e-06   |
|    learning_rate        | 0.0003      |
|    loss                 | 3.6e+04     |
|    n_updates            | 190         |
|    policy_gradient_loss | -0.000372   |
|    std                  | 0.36        |
|    value_loss           | 7.36e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 21          |
|    time_elapsed         | 397         |
|    total_timesteps      | 21504       |
| train/                  |             |
|    approx_kl            | 0.008446337 |
|    clip_fraction        | 0.0791      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.2        |
|    explained_variance   | 5.66e-06    |
|    learning_rate        | 0.0003      |
|    loss                 | 2.64e+04    |
|    n_updates            | 200         |
|    policy_gradient_loss | -0.00249    |
|    std                  | 0.362       |
|    value_loss           | 5.07e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 22          |
|    time_elapsed         | 415         |
|    total_timesteps      | 22528       |
| train/                  |             |
|    approx_kl            | 0.006371121 |
|    clip_fraction        | 0.0755      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.21       |
|    explained_variance   | -2.38e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 3.18e+04    |
|    n_updates            | 210         |
|    policy_gradient_loss | -0.000161   |
|    std                  | 0.361       |
|    value_loss           | 6.65e+04    |
-----------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 54         |
|    iterations           | 23         |
|    time_elapsed         | 433        |
|    total_timesteps      | 23552      |
| train/                  |            |
|    approx_kl            | 0.01314253 |
|    clip_fraction        | 0.136      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.2       |
|    explained_variance   | -1.19e-07  |
|    learning_rate        | 0.0003     |
|    loss                 | 3.57e+04   |
|    n_updates            | 220        |
|    policy_gradient_loss | -0.00107   |
|    std                  | 0.36       |
|    value_loss           | 7.27e+04   |
----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 24          |
|    time_elapsed         | 451         |
|    total_timesteps      | 24576       |
| train/                  |             |
|    approx_kl            | 0.010848595 |
|    clip_fraction        | 0.125       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.19       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 3.5e+04     |
|    n_updates            | 230         |
|    policy_gradient_loss | -0.000769   |
|    std                  | 0.36        |
|    value_loss           | 7.2e+04     |
-----------------------------------------
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 105, in <module>
    rclpy.shutdown()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 70, in main
    device="cpu"
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 202, in collect_rollouts
    actions, values, log_probs = self.policy(obs_tensor)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1881, in _call_impl
    return inner()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1829, in inner
    result = forward_call(*args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 654, in forward
    distribution = self._get_action_dist_from_latent(latent_pi)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 694, in _get_action_dist_from_latent
    return self.action_dist.proba_distribution(mean_actions, self.log_std)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/distributions.py", line 164, in proba_distribution
    self.distribution = Normal(mean_actions, action_std)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/distributions/normal.py", line 66, in __init__
    super().__init__(batch_shape, validate_args=validate_args)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/distributions/distribution.py", line 75, in __init__
    valid = constraint.check(value)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 105, in <module>
    rclpy.shutdown()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 70, in main
    device="cpu"
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 202, in collect_rollouts
    actions, values, log_probs = self.policy(obs_tensor)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1881, in _call_impl
    return inner()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1829, in inner
    result = forward_call(*args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 654, in forward
    distribution = self._get_action_dist_from_latent(latent_pi)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 694, in _get_action_dist_from_latent
    return self.action_dist.proba_distribution(mean_actions, self.log_std)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/distributions.py", line 164, in proba_distribution
    self.distribution = Normal(mean_actions, action_std)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/distributions/normal.py", line 66, in __init__
    super().__init__(batch_shape, validate_args=validate_args)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/torch/distributions/distribution.py", line 75, in __init__
    valid = constraint.check(value)
KeyboardInterrupt
