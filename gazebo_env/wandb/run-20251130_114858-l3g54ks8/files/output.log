Using cpu device
Spawning roof obstacle with fixed size and color
-----------------------------
| time/              |      |
|    fps             | 49   |
|    iterations      | 1    |
|    time_elapsed    | 20   |
|    total_timesteps | 1024 |
-----------------------------
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    main()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    model.learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 477, in step
    u_safe = self._solve_projection(u_rl, self.pos)
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 389, in _solve_projection
    res = minimize(obj, x0, jac=jac, bounds=bounds, constraints=cons,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_minimize.py", line 750, in minimize
    res = _minimize_slsqp(fun, x0, args, jac, bounds,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_slsqp_py.py", line 381, in _minimize_slsqp
    sf = _prepare_scalar_function(func, x, jac=jac, args=args, epsilon=eps,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 376, in obj
    return 0.5 * np.sum((u - u_rl)**2)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/numpy/_core/fromnumeric.py", line 2333, in _sum_dispatcher
    def _sum_dispatcher(a, axis=None, dtype=None, out=None, keepdims=None,
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    main()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    model.learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 477, in step
    u_safe = self._solve_projection(u_rl, self.pos)
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 389, in _solve_projection
    res = minimize(obj, x0, jac=jac, bounds=bounds, constraints=cons,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_minimize.py", line 750, in minimize
    res = _minimize_slsqp(fun, x0, args, jac, bounds,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_slsqp_py.py", line 381, in _minimize_slsqp
    sf = _prepare_scalar_function(func, x, jac=jac, args=args, epsilon=eps,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 376, in obj
    return 0.5 * np.sum((u - u_rl)**2)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/numpy/_core/fromnumeric.py", line 2333, in _sum_dispatcher
    def _sum_dispatcher(a, axis=None, dtype=None, out=None, keepdims=None,
KeyboardInterrupt
