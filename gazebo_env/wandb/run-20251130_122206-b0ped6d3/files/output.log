Using cpu device
Spawning roof obstacle with fixed size and color
-----------------------------
| time/              |      |
|    fps             | 49   |
|    iterations      | 1    |
|    time_elapsed    | 20   |
|    total_timesteps | 1024 |
-----------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 2           |
|    time_elapsed         | 38          |
|    total_timesteps      | 2048        |
| train/                  |             |
|    approx_kl            | 0.005513613 |
|    clip_fraction        | 0.0783      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.25       |
|    explained_variance   | -0.000591   |
|    learning_rate        | 0.0003      |
|    loss                 | 3.01e+04    |
|    n_updates            | 10          |
|    policy_gradient_loss | 0.00138     |
|    std                  | 0.368       |
|    value_loss           | 5.64e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 3           |
|    time_elapsed         | 56          |
|    total_timesteps      | 3072        |
| train/                  |             |
|    approx_kl            | 0.005644022 |
|    clip_fraction        | 0.0463      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.25       |
|    explained_variance   | 0.000192    |
|    learning_rate        | 0.0003      |
|    loss                 | 2.72e+04    |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.000357   |
|    std                  | 0.367       |
|    value_loss           | 5.54e+04    |
-----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 54           |
|    iterations           | 4            |
|    time_elapsed         | 74           |
|    total_timesteps      | 4096         |
| train/                  |              |
|    approx_kl            | 0.0056066774 |
|    clip_fraction        | 0.113        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.26        |
|    explained_variance   | 7.15e-07     |
|    learning_rate        | 0.0003       |
|    loss                 | 3.68e+04     |
|    n_updates            | 30           |
|    policy_gradient_loss | -0.000794    |
|    std                  | 0.369        |
|    value_loss           | 7.49e+04     |
------------------------------------------
Spawning roof obstacle with fixed size and color
------------------------------------------
| time/                   |              |
|    fps                  | 50           |
|    iterations           | 5            |
|    time_elapsed         | 100          |
|    total_timesteps      | 5120         |
| train/                  |              |
|    approx_kl            | 0.0060797664 |
|    clip_fraction        | 0.118        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.26        |
|    explained_variance   | 5.96e-07     |
|    learning_rate        | 0.0003       |
|    loss                 | 3.8e+04      |
|    n_updates            | 40           |
|    policy_gradient_loss | -0.00214     |
|    std                  | 0.366        |
|    value_loss           | 7.58e+04     |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 51          |
|    iterations           | 6           |
|    time_elapsed         | 118         |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.006072571 |
|    clip_fraction        | 0.0938      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.24       |
|    explained_variance   | 0.000298    |
|    learning_rate        | 0.0003      |
|    loss                 | 2.56e+04    |
|    n_updates            | 50          |
|    policy_gradient_loss | 0.00438     |
|    std                  | 0.365       |
|    value_loss           | 4.82e+04    |
-----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 52           |
|    iterations           | 7            |
|    time_elapsed         | 136          |
|    total_timesteps      | 7168         |
| train/                  |              |
|    approx_kl            | 0.0060494235 |
|    clip_fraction        | 0.0912       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.22        |
|    explained_variance   | -0.000232    |
|    learning_rate        | 0.0003       |
|    loss                 | 1.69e+04     |
|    n_updates            | 60           |
|    policy_gradient_loss | 0.000161     |
|    std                  | 0.362        |
|    value_loss           | 3.42e+04     |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 53          |
|    iterations           | 8           |
|    time_elapsed         | 154         |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.006499381 |
|    clip_fraction        | 0.0737      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.19       |
|    explained_variance   | 7.59e-05    |
|    learning_rate        | 0.0003      |
|    loss                 | 1.6e+04     |
|    n_updates            | 70          |
|    policy_gradient_loss | 8.11e-05    |
|    std                  | 0.359       |
|    value_loss           | 3.36e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 53          |
|    iterations           | 9           |
|    time_elapsed         | 172         |
|    total_timesteps      | 9216        |
| train/                  |             |
|    approx_kl            | 0.009985823 |
|    clip_fraction        | 0.174       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.18       |
|    explained_variance   | -3.35e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 8.77e+03    |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.000403   |
|    std                  | 0.359       |
|    value_loss           | 1.69e+04    |
-----------------------------------------
Spawning roof obstacle with fixed size and color
-----------------------------------------
| time/                   |             |
|    fps                  | 51          |
|    iterations           | 10          |
|    time_elapsed         | 198         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.004385178 |
|    clip_fraction        | 0.0709      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.17       |
|    explained_variance   | -0.000231   |
|    learning_rate        | 0.0003      |
|    loss                 | 2.38e+04    |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0024     |
|    std                  | 0.357       |
|    value_loss           | 5.37e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 11          |
|    time_elapsed         | 216         |
|    total_timesteps      | 11264       |
| train/                  |             |
|    approx_kl            | 0.004949513 |
|    clip_fraction        | 0.0857      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.17       |
|    explained_variance   | 1.82e-05    |
|    learning_rate        | 0.0003      |
|    loss                 | 2.9e+04     |
|    n_updates            | 100         |
|    policy_gradient_loss | 0.000708    |
|    std                  | 0.357       |
|    value_loss           | 5.68e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 12          |
|    time_elapsed         | 234         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.011435942 |
|    clip_fraction        | 0.16        |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.16       |
|    explained_variance   | 4.77e-07    |
|    learning_rate        | 0.0003      |
|    loss                 | 1.51e+04    |
|    n_updates            | 110         |
|    policy_gradient_loss | 0.0014      |
|    std                  | 0.356       |
|    value_loss           | 3.1e+04     |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 13          |
|    time_elapsed         | 252         |
|    total_timesteps      | 13312       |
| train/                  |             |
|    approx_kl            | 0.017647808 |
|    clip_fraction        | 0.134       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.15       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 1.51e+04    |
|    n_updates            | 120         |
|    policy_gradient_loss | 0.00478     |
|    std                  | 0.354       |
|    value_loss           | 3.09e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 53          |
|    iterations           | 14          |
|    time_elapsed         | 269         |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 0.009564342 |
|    clip_fraction        | 0.152       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.15       |
|    explained_variance   | -1.19e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 1.52e+04    |
|    n_updates            | 130         |
|    policy_gradient_loss | 0.00366     |
|    std                  | 0.355       |
|    value_loss           | 3.08e+04    |
-----------------------------------------
Spawning roof obstacle with fixed size and color
----------------------------------------
| time/                   |            |
|    fps                  | 51         |
|    iterations           | 15         |
|    time_elapsed         | 295        |
|    total_timesteps      | 15360      |
| train/                  |            |
|    approx_kl            | 0.01973714 |
|    clip_fraction        | 0.175      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.14      |
|    explained_variance   | 5.96e-08   |
|    learning_rate        | 0.0003     |
|    loss                 | 1.45e+04   |
|    n_updates            | 140        |
|    policy_gradient_loss | 0.00195    |
|    std                  | 0.354      |
|    value_loss           | 3.06e+04   |
----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 52           |
|    iterations           | 16           |
|    time_elapsed         | 313          |
|    total_timesteps      | 16384        |
| train/                  |              |
|    approx_kl            | 0.0060827513 |
|    clip_fraction        | 0.0713       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.15        |
|    explained_variance   | 4.17e-06     |
|    learning_rate        | 0.0003       |
|    loss                 | 1.09e+04     |
|    n_updates            | 150          |
|    policy_gradient_loss | -0.000175    |
|    std                  | 0.356        |
|    value_loss           | 2.12e+04     |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 17          |
|    time_elapsed         | 331         |
|    total_timesteps      | 17408       |
| train/                  |             |
|    approx_kl            | 0.009626094 |
|    clip_fraction        | 0.129       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.16       |
|    explained_variance   | -5.84e-06   |
|    learning_rate        | 0.0003      |
|    loss                 | 1.13e+04    |
|    n_updates            | 160         |
|    policy_gradient_loss | -0.000335   |
|    std                  | 0.356       |
|    value_loss           | 2.38e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 18          |
|    time_elapsed         | 349         |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.010171827 |
|    clip_fraction        | 0.137       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.15       |
|    explained_variance   | 3.58e-07    |
|    learning_rate        | 0.0003      |
|    loss                 | 1.55e+04    |
|    n_updates            | 170         |
|    policy_gradient_loss | 0.000315    |
|    std                  | 0.355       |
|    value_loss           | 3.13e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 19          |
|    time_elapsed         | 367         |
|    total_timesteps      | 19456       |
| train/                  |             |
|    approx_kl            | 0.010661233 |
|    clip_fraction        | 0.16        |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.15       |
|    explained_variance   | -1.19e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 1.57e+04    |
|    n_updates            | 180         |
|    policy_gradient_loss | 0.00226     |
|    std                  | 0.355       |
|    value_loss           | 3.16e+04    |
-----------------------------------------
Spawning roof obstacle with fixed size and color
------------------------------------------
| time/                   |              |
|    fps                  | 52           |
|    iterations           | 20           |
|    time_elapsed         | 393          |
|    total_timesteps      | 20480        |
| train/                  |              |
|    approx_kl            | 0.0048586847 |
|    clip_fraction        | 0.119        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.15        |
|    explained_variance   | 2.98e-07     |
|    learning_rate        | 0.0003       |
|    loss                 | 1.55e+04     |
|    n_updates            | 190          |
|    policy_gradient_loss | 0.000725     |
|    std                  | 0.357        |
|    value_loss           | 3.13e+04     |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 21          |
|    time_elapsed         | 411         |
|    total_timesteps      | 21504       |
| train/                  |             |
|    approx_kl            | 0.006767893 |
|    clip_fraction        | 0.0816      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.16       |
|    explained_variance   | 4.35e-06    |
|    learning_rate        | 0.0003      |
|    loss                 | 1.11e+04    |
|    n_updates            | 200         |
|    policy_gradient_loss | -0.000685   |
|    std                  | 0.356       |
|    value_loss           | 2.32e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 22          |
|    time_elapsed         | 429         |
|    total_timesteps      | 22528       |
| train/                  |             |
|    approx_kl            | 0.010321695 |
|    clip_fraction        | 0.112       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.17       |
|    explained_variance   | -4.24e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 5.68e+03    |
|    n_updates            | 210         |
|    policy_gradient_loss | 0.00254     |
|    std                  | 0.358       |
|    value_loss           | 1.19e+04    |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 23          |
|    time_elapsed         | 447         |
|    total_timesteps      | 23552       |
| train/                  |             |
|    approx_kl            | 0.004912966 |
|    clip_fraction        | 0.0911      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.17       |
|    explained_variance   | -4.21e-05   |
|    learning_rate        | 0.0003      |
|    loss                 | 9.17e+03    |
|    n_updates            | 220         |
|    policy_gradient_loss | -0.00131    |
|    std                  | 0.357       |
|    value_loss           | 1.84e+04    |
-----------------------------------------
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    print("Test finished.")
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    batch_size=wandb.config.batch_size,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 502, in step
    rclpy.spin_once(self, timeout_sec=self.dt)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/__init__.py", line 206, in spin_once
    executor.spin_once(timeout_sec=timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 739, in spin_once
    self._spin_once_impl(timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 728, in _spin_once_impl
    handler, entity, node = self.wait_for_ready_callbacks(timeout_sec=timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 711, in wait_for_ready_callbacks
    return next(self._cb_iter)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 608, in _wait_for_ready_callbacks
    wait_set.wait(timeout_nsec)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    print("Test finished.")
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    batch_size=wandb.config.batch_size,
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
  File "/home/wenjia/CBFRL/gazebo_env/env_gazebo.py", line 502, in step
    rclpy.spin_once(self, timeout_sec=self.dt)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/__init__.py", line 206, in spin_once
    executor.spin_once(timeout_sec=timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 739, in spin_once
    self._spin_once_impl(timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 728, in _spin_once_impl
    handler, entity, node = self.wait_for_ready_callbacks(timeout_sec=timeout_sec)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 711, in wait_for_ready_callbacks
    return next(self._cb_iter)
  File "/opt/ros/humble/local/lib/python3.10/dist-packages/rclpy/executors.py", line 608, in _wait_for_ready_callbacks
    wait_set.wait(timeout_nsec)
KeyboardInterrupt
