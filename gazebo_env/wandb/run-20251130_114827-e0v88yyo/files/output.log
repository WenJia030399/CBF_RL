Using cpu device
Spawning roof obstacle with fixed size and color
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    main()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    model.learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 224, in collect_rollouts
    if not callback.on_step():
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 114, in on_step
    return self._on_step()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 223, in _on_step
    continue_training = callback.on_step() and continue_training
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 114, in on_step
    return self._on_step()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 27, in _on_step
    wandb.log({"env/min_obstacle_dist": infos["min_dist_to_obstacle"]})
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 390, in wrapper
    return func(self, *args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 448, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 435, in wrapper
    return func(self, *args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 2023, in log
    self._log(data=data, step=step, commit=commit)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1734, in _log
    self._partial_history_callback(data, step, commit)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 390, in wrapper
    return func(self, *args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1562, in _partial_history_callback
    self._backend.interface.publish_partial_history(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 710, in publish_partial_history
    item.value_json = json_dumps_safer_history(v)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/util.py", line 862, in json_dumps_safer_history
    return dumps(obj, cls=WandBHistoryJSONEncoder, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 109, in <module>
    main()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 74, in main
    model.learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 224, in collect_rollouts
    if not callback.on_step():
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 114, in on_step
    return self._on_step()
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 223, in _on_step
    continue_training = callback.on_step() and continue_training
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 114, in on_step
    return self._on_step()
  File "/home/wenjia/CBFRL/gazebo_env/train.py", line 27, in _on_step
    wandb.log({"env/min_obstacle_dist": infos["min_dist_to_obstacle"]})
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 390, in wrapper
    return func(self, *args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 448, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 435, in wrapper
    return func(self, *args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 2023, in log
    self._log(data=data, step=step, commit=commit)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1734, in _log
    self._partial_history_callback(data, step, commit)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 390, in wrapper
    return func(self, *args, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1562, in _partial_history_callback
    self._backend.interface.publish_partial_history(
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 710, in publish_partial_history
    item.value_json = json_dumps_safer_history(v)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/site-packages/wandb/util.py", line 862, in json_dumps_safer_history
    return dumps(obj, cls=WandBHistoryJSONEncoder, **kwargs)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/wenjia/miniconda3/envs/rl/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
KeyboardInterrupt
